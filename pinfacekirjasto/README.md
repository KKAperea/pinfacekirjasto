## Описание программы

Данный репозиторий содержит реализацию класса `PinFace`, который предназначен для обнаружения и распознавания лиц на изображениях. Программа использует различные библиотеки и методы для выполнения этих задач, включая OpenCV, AdaFace, SFace и MTCNN.

## Основные функции

### Инициализация класса `PinFace`

Класс `PinFace` инициализируется с указанием режимов обнаружения (`ffmode`) и распознавания (`frmode`) лиц. Доступные режимы:
- **Обнаружение лиц**: `opencv`, `adaface`
- **Распознавание лиц**: `sface`, `mtcnn`

### Метод `face_detection`

Метод `face_detection` выполняет обнаружение лиц на переданном изображении. Возвращает:
- Координаты ограничивающих прямоугольников (`bboxes`)
- Список изображений лиц в формате PIL.Image (`faces`)
- Список изображений лиц в формате OpenCV (`facescv`)

### Метод `face_recognition`

Метод `face_recognition` выполняет распознавание лиц на основе обнаруженных изображений. Возвращает список эмбеддингов (векторных представлений) для каждого лица.

## Оптимизация и улучшения

1. **Улучшение читаемости кода**:
   - Добавлены подробные комментарии к каждому методу и блоку кода.
   - Упрощена логика проверки и обработки входных данных.

2. **Оптимизация скорости выполнения**:
   - Уменьшено количество операций преобразования изображений между форматами.
   - Использованы более эффективные методы для работы с массивами и изображениями.

3. **Улучшение восприятия**:
   - Добавлены пояснения к каждому этапу обработки изображений.
   - Улучшена структура кода для лучшего понимания логики работы.

## Пример использования

```python
# Инициализация класса PinFace
pin_face = PinFace(ffmode='opencv', frmode='sface')
```

```python
# Загрузка изображения
image = Image.open('path_to_image.jpg')
```

```python
# Обнаружение лиц
bboxes, faces, facescv = pin_face.face_detection(image)
```

```python
# Распознавание лиц
embeddings = pin_face.face_recognition(bboxes, faces, facescv)
```

```python
# Вывод результатов
print(f"Обнаружено лиц: {len(embeddings)}")
```

## Зависимости

Для работы программы необходимы следующие библиотеки:

- **PIL (Pillow)**  
  Библиотека для работы с изображениями.
  
- **numpy**  
  Библиотека для работы с массивами и математическими операциями.

- **opencv-python**  
  Библиотека OpenCV для обработки изображений и компьютерного зрения.

- **Дополнительные модули из `pinfacekirjasto`**  
  Специальные модули, используемые для обнаружения и распознавания лиц.

## Заключение

Данная программа представляет собой мощный инструмент для работы с изображениями лиц, обеспечивая высокую точность и скорость обработки. Рекомендуется использовать её в проектах, связанных с компьютерным зрением и биометрией.